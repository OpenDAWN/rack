<!DOCTYPE HTML>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="../build/build.css" />
    <link rel="stylesheet" href="../rack.css" />
    <title></title>
  </head>
  <body>
    <script src="../build/build.js" type="text/javascript"></script>
    <script type="text/javascript">
      var Rack  = require('rack');
      var allen = require('jsantell-allen/allen.js');
      var ctx   = allen.getAudioContext();

      /**
       * When testing, require and instantiate
       * your own module here
       */
      var Module = require('web-audio-components-delay');
      var module = new Module(ctx, 2, 1.0, 0.8);

      /**
       * ^^^^^^^^^^
       */

      var rack  = new Rack(module);
      var xhr = allen.getBuffer('human-voice.wav', function () {
        ctx.decodeAudioData(xhr.response, function (buffer) {
          var node = ctx.createBufferSource();
          node.buffer = buffer;

          node.connect(module.input);
          module.connect(ctx.destination);

          node[node.start ? 'start' : 'noteOn'](0);
        });
      }, true);

    </script>
    <div id="container">
    </div>
    <script>
        document.getElementById('container').appendChild(rack.el);
    </script>
  </body>
</html>
